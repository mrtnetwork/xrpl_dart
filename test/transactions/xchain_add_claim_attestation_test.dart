import 'package:test/test.dart';
import 'package:xrpl_dart/src/xrpl/models/xrp_transactions.dart';

void main() {
  test("XChainAddClaimAttestation JSON", () {
    final json = {
      "account": "rakX3RZ8EUjxGueysWag5QyCgXymK6rqSL",
      "transaction_type": "XChainAddClaimAttestation",
      "fee": "10",
      "sequence": 10,
      "last_ledger_sequence": 8548692,
      "signing_pub_key":
          "031B9797537DC10B29738C43FBDB743D10354A0057B3327338E6EAE6A47BF6791E",
      "txn_signature":
          "304402200F480ED9FFEB892F936692B71ABA7F26D960153E2BF5D9774976189497F55271022060FED6E0F27C15A0DF626A85EC2DA59E214780906982EC63BFB0BD20327F34B0",
      "xchain_bridge": {
        "locking_chain_door": "rPFV632NxvfcuQ95daQv8LTLwHecz3taRw",
        "locking_chain_issue": {"currency": "XRP"},
        "issuing_chain_door": "rHb9CJAWyB4rj91VRWn96DkukG4bwdtyTh",
        "issuing_chain_issue": {"currency": "XRP"}
      },
      "public_key":
          "039615A956E529D324337AADA824A6E05F4EC3C1380ECE020BE3CF5A5BF50D2DA0",
      "signature":
          "30440220775C14A0EC524BB2EB4E5E3BAA910A9B95C9BC6B1751002FB80006C90E199DD802205A68B403ACC03C25527CF2012F46EFCC35D43206E9A0F9CA93FB5F9D63220FF9",
      "other_chain_source": "rJjye19Hi9fkWTE7FERdEoXmrPt4p6tN5e",
      "amount": "2000",
      "attestation_reward_account": "rakX3RZ8EUjxGueysWag5QyCgXymK6rqSL",
      "attestation_signer_account": "rakX3RZ8EUjxGueysWag5QyCgXymK6rqSL",
      "was_locking_chain_send": 0,
      "xchain_claim_id": 123123123123,
      "destination": "rMRNfC38abgejshALTCMJL2W9XRzN8SXDn"
    };
    final transaction = XChainAddClaimAttestation.fromJson(json);
    expect(transaction.toJson(), json);

    expect(transaction.toBlob(forSigning: false),
        "12002D240000000A201B0082715430140000001CAAB5C3B36140000000000007D068400000000000000A7121039615A956E529D324337AADA824A6E05F4EC3C1380ECE020BE3CF5A5BF50D2DA07321031B9797537DC10B29738C43FBDB743D10354A0057B3327338E6EAE6A47BF6791E7446304402200F480ED9FFEB892F936692B71ABA7F26D960153E2BF5D9774976189497F55271022060FED6E0F27C15A0DF626A85EC2DA59E214780906982EC63BFB0BD20327F34B0764630440220775C14A0EC524BB2EB4E5E3BAA910A9B95C9BC6B1751002FB80006C90E199DD802205A68B403ACC03C25527CF2012F46EFCC35D43206E9A0F9CA93FB5F9D63220FF981143F13AA3412432DF3943B9507ABC3BC40174EC9C78314DFF772492C5C618573B27BE95A0D05FD5C00F5E0801214C29AE66EA745D4E62B674FCE4DAC34A09B1F1A3E8014143F13AA3412432DF3943B9507ABC3BC40174EC9C78015143F13AA3412432DF3943B9507ABC3BC40174EC9C700101300011914FA4E44ABAC11C26F09651C4C914705357B03627C000000000000000000000000000000000000000014B5F762798A53D543A014CAF8B297CFF8F2F937E80000000000000000000000000000000000000000");
    final fromBlob =
        SubmittableTransaction.fromBlob(transaction.toBlob(forSigning: false));
    expect(fromBlob.toBlob(), transaction.toBlob());
  });

  test("XChainAddClaimAttestation XRPL", () {
    final json = {
      "Account": "rakX3RZ8EUjxGueysWag5QyCgXymK6rqSL",
      "TransactionType": "XChainAddClaimAttestation",
      "Fee": "10",
      "Sequence": 10,
      "LastLedgerSequence": 8548692,
      "SigningPubKey":
          "031B9797537DC10B29738C43FBDB743D10354A0057B3327338E6EAE6A47BF6791E",
      "TxnSignature":
          "304402200F480ED9FFEB892F936692B71ABA7F26D960153E2BF5D9774976189497F55271022060FED6E0F27C15A0DF626A85EC2DA59E214780906982EC63BFB0BD20327F34B0",
      "XChainBridge": {
        "LockingChainDoor": "rPFV632NxvfcuQ95daQv8LTLwHecz3taRw",
        "LockingChainIssue": {"currency": "XRP"},
        "IssuingChainDoor": "rHb9CJAWyB4rj91VRWn96DkukG4bwdtyTh",
        "IssuingChainIssue": {"currency": "XRP"}
      },
      "PublicKey":
          "039615A956E529D324337AADA824A6E05F4EC3C1380ECE020BE3CF5A5BF50D2DA0",
      "Signature":
          "30440220775C14A0EC524BB2EB4E5E3BAA910A9B95C9BC6B1751002FB80006C90E199DD802205A68B403ACC03C25527CF2012F46EFCC35D43206E9A0F9CA93FB5F9D63220FF9",
      "OtherChainSource": "rJjye19Hi9fkWTE7FERdEoXmrPt4p6tN5e",
      "Amount": "2000",
      "AttestationRewardAccount": "rakX3RZ8EUjxGueysWag5QyCgXymK6rqSL",
      "AttestationSignerAccount": "rakX3RZ8EUjxGueysWag5QyCgXymK6rqSL",
      "WasLockingChainSend": 0,
      "XChainClaimID": 123123123123,
      "Destination": "rMRNfC38abgejshALTCMJL2W9XRzN8SXDn"
    };
    final transaction = SubmittableTransaction.fromXrpl(json);
    expect(transaction.toXrpl(), json);
    expect(transaction.toBlob(forSigning: false),
        "12002D240000000A201B0082715430140000001CAAB5C3B36140000000000007D068400000000000000A7121039615A956E529D324337AADA824A6E05F4EC3C1380ECE020BE3CF5A5BF50D2DA07321031B9797537DC10B29738C43FBDB743D10354A0057B3327338E6EAE6A47BF6791E7446304402200F480ED9FFEB892F936692B71ABA7F26D960153E2BF5D9774976189497F55271022060FED6E0F27C15A0DF626A85EC2DA59E214780906982EC63BFB0BD20327F34B0764630440220775C14A0EC524BB2EB4E5E3BAA910A9B95C9BC6B1751002FB80006C90E199DD802205A68B403ACC03C25527CF2012F46EFCC35D43206E9A0F9CA93FB5F9D63220FF981143F13AA3412432DF3943B9507ABC3BC40174EC9C78314DFF772492C5C618573B27BE95A0D05FD5C00F5E0801214C29AE66EA745D4E62B674FCE4DAC34A09B1F1A3E8014143F13AA3412432DF3943B9507ABC3BC40174EC9C78015143F13AA3412432DF3943B9507ABC3BC40174EC9C700101300011914FA4E44ABAC11C26F09651C4C914705357B03627C000000000000000000000000000000000000000014B5F762798A53D543A014CAF8B297CFF8F2F937E80000000000000000000000000000000000000000");
    final fromBlob =
        SubmittableTransaction.fromBlob(transaction.toBlob(forSigning: false));
    expect(fromBlob.toBlob(), transaction.toBlob());
  });
}
