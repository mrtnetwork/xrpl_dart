import 'package:test/test.dart';
import 'package:xrpl_dart/src/xrpl/models/xrp_transactions.dart';

void main() {
  test("XChainAddAccountCreateAttestation JSON", () {
    final json = {
      "account": "rakX3RZ8EUjxGueysWag5QyCgXymK6rqSL",
      "transaction_type": "XChainAddAccountCreateAttestation",
      "fee": "10",
      "sequence": 10,
      "last_ledger_sequence": 8548692,
      "signing_pub_key":
          "031B9797537DC10B29738C43FBDB743D10354A0057B3327338E6EAE6A47BF6791E",
      "txn_signature":
          "304402203AA1D8A2C120DCDF303518461F24280A4ABD05D93B59B2B56C4FCF96C23FAE8E02202650FC59391DAE2A5AD6ED6293F490B4E2C48F74F8A644316F0F738E83443F48",
      "xchain_bridge": {
        "locking_chain_door": "rPFV632NxvfcuQ95daQv8LTLwHecz3taRw",
        "locking_chain_issue": {"currency": "XRP"},
        "issuing_chain_door": "rHb9CJAWyB4rj91VRWn96DkukG4bwdtyTh",
        "issuing_chain_issue": {"currency": "XRP"}
      },
      "public_key":
          "039615A956E529D324337AADA824A6E05F4EC3C1380ECE020BE3CF5A5BF50D2DA0",
      "signature":
          "3045022100C571B870DDCD645C061CD373638EEE3D247D5DD33F9625CB6BA564DBC2525E18022032FAFFE0118DDE3B62B02A4F44FF92617896B9557799FE320ABB14E981BECED7",
      "other_chain_source": "rKCTfaMHeLmcnmZZwBzVNHj9acd7U3o8F3",
      "amount": "300000000",
      "attestation_reward_account": "rakX3RZ8EUjxGueysWag5QyCgXymK6rqSL",
      "attestation_signer_account": "rakX3RZ8EUjxGueysWag5QyCgXymK6rqSL",
      "was_locking_chain_send": 0,
      "xchain_account_create_count": 12,
      "destination": "rnDt4sUy6mfsB5uwCF43bbvBUus87MaGEi",
      "signature_reward": "200"
    };
    final transaction = XChainAddAccountCreateAttestation.fromJson(json);
    expect(transaction.toJson(), json);

    expect(transaction.toTransactionBlob(),
        "12002E240000000A201B008271543015000000000000000C614000000011E1A30068400000000000000A601D40000000000000C87121039615A956E529D324337AADA824A6E05F4EC3C1380ECE020BE3CF5A5BF50D2DA07321031B9797537DC10B29738C43FBDB743D10354A0057B3327338E6EAE6A47BF6791E7446304402203AA1D8A2C120DCDF303518461F24280A4ABD05D93B59B2B56C4FCF96C23FAE8E02202650FC59391DAE2A5AD6ED6293F490B4E2C48F74F8A644316F0F738E83443F4876473045022100C571B870DDCD645C061CD373638EEE3D247D5DD33F9625CB6BA564DBC2525E18022032FAFFE0118DDE3B62B02A4F44FF92617896B9557799FE320ABB14E981BECED781143F13AA3412432DF3943B9507ABC3BC40174EC9C783142E505EC0313FBC9CB8BD491E780036DCA81776BA801214CCB7DCAEF7995F7075AB2B84D5314F274DC719B58014143F13AA3412432DF3943B9507ABC3BC40174EC9C78015143F13AA3412432DF3943B9507ABC3BC40174EC9C700101300011914FA4E44ABAC11C26F09651C4C914705357B03627C000000000000000000000000000000000000000014B5F762798A53D543A014CAF8B297CFF8F2F937E80000000000000000000000000000000000000000");
    final fromBlob =
        SubmittableTransaction.fromBlob(transaction.toTransactionBlob());
    expect(fromBlob.toTransactionBlob(), transaction.toTransactionBlob());
  });

  test("XChainAddAccountCreateAttestation XRPL", () {
    final json = {
      "Account": "rakX3RZ8EUjxGueysWag5QyCgXymK6rqSL",
      "TransactionType": "XChainAddAccountCreateAttestation",
      "Fee": "10",
      "Sequence": 10,
      "LastLedgerSequence": 8548692,
      "SigningPubKey":
          "031B9797537DC10B29738C43FBDB743D10354A0057B3327338E6EAE6A47BF6791E",
      "TxnSignature":
          "304402203AA1D8A2C120DCDF303518461F24280A4ABD05D93B59B2B56C4FCF96C23FAE8E02202650FC59391DAE2A5AD6ED6293F490B4E2C48F74F8A644316F0F738E83443F48",
      "XChainBridge": {
        "LockingChainDoor": "rPFV632NxvfcuQ95daQv8LTLwHecz3taRw",
        "LockingChainIssue": {"currency": "XRP"},
        "IssuingChainDoor": "rHb9CJAWyB4rj91VRWn96DkukG4bwdtyTh",
        "IssuingChainIssue": {"currency": "XRP"}
      },
      "PublicKey":
          "039615A956E529D324337AADA824A6E05F4EC3C1380ECE020BE3CF5A5BF50D2DA0",
      "Signature":
          "3045022100C571B870DDCD645C061CD373638EEE3D247D5DD33F9625CB6BA564DBC2525E18022032FAFFE0118DDE3B62B02A4F44FF92617896B9557799FE320ABB14E981BECED7",
      "OtherChainSource": "rKCTfaMHeLmcnmZZwBzVNHj9acd7U3o8F3",
      "Amount": "300000000",
      "AttestationRewardAccount": "rakX3RZ8EUjxGueysWag5QyCgXymK6rqSL",
      "AttestationSignerAccount": "rakX3RZ8EUjxGueysWag5QyCgXymK6rqSL",
      "WasLockingChainSend": 0,
      "XChainAccountCreateCount": 12,
      "Destination": "rnDt4sUy6mfsB5uwCF43bbvBUus87MaGEi",
      "SignatureReward": "200"
    };
    final transaction = SubmittableTransaction.fromXrpl(json);
    expect(transaction.toXrpl(), json);
    expect(transaction.toTransactionBlob(),
        "12002E240000000A201B008271543015000000000000000C614000000011E1A30068400000000000000A601D40000000000000C87121039615A956E529D324337AADA824A6E05F4EC3C1380ECE020BE3CF5A5BF50D2DA07321031B9797537DC10B29738C43FBDB743D10354A0057B3327338E6EAE6A47BF6791E7446304402203AA1D8A2C120DCDF303518461F24280A4ABD05D93B59B2B56C4FCF96C23FAE8E02202650FC59391DAE2A5AD6ED6293F490B4E2C48F74F8A644316F0F738E83443F4876473045022100C571B870DDCD645C061CD373638EEE3D247D5DD33F9625CB6BA564DBC2525E18022032FAFFE0118DDE3B62B02A4F44FF92617896B9557799FE320ABB14E981BECED781143F13AA3412432DF3943B9507ABC3BC40174EC9C783142E505EC0313FBC9CB8BD491E780036DCA81776BA801214CCB7DCAEF7995F7075AB2B84D5314F274DC719B58014143F13AA3412432DF3943B9507ABC3BC40174EC9C78015143F13AA3412432DF3943B9507ABC3BC40174EC9C700101300011914FA4E44ABAC11C26F09651C4C914705357B03627C000000000000000000000000000000000000000014B5F762798A53D543A014CAF8B297CFF8F2F937E80000000000000000000000000000000000000000");
    final fromBlob =
        SubmittableTransaction.fromBlob(transaction.toTransactionBlob());
    expect(fromBlob.toTransactionBlob(), transaction.toTransactionBlob());
  });
}
